<% current_line ||= nil %>
<% options ||= {} %>

<li class="stop">
  <div class="line-mark">
  <% if @line != nil && @line.color %>
      <div class="mark-box" style="background: <%= "##{@line.color}" %>"></div>
      <div class="mark-circle" style="border-color: <%= "##{@line.color}" %>"></div>
    <% else %>
      <div class="mark-box"></div>
      <div class="mark-circle"></div>
    <% end %>
</div>
<div class="row-container">
  <%= link_to stop, class: 'centered row' do %>
  <% if options.fetch(:show_icon, false) %>
      <%= image_tag((stop.bus? ? "bus.svg" : "train.svg"), alt: '', class: "small") %>
    <% end %>
    <span class="stop-name"><%= stop.name %></span>
    <% if stop.train? %>
      <% if options.fetch(:show_line_colors, true) %>
        <div class="stop-colors">
          <% stop.lines.each do |line| %>
            <div class="color-stripe" style="background-color: <%= "##{line.color}" %>"></div>
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% end %>
  <div class="centered row">
    <span><%= stop.issues.length %></span>
    <% if user_signed_in? %>
      <% if current_user.favorites.include?(stop) %>
        <%= render "favorites/favorite", stop: stop %>
      <% else %>
        <%= render "favorites/unfavorite", stop: stop %>
      <% end %>
    <% end %>
    <% if options.fetch(:show_add_issue_button, true) %>
      <%= new_issue_button(stop: stop, line: current_line) %>
    <% end %>
  </div>
</div>
</li>
