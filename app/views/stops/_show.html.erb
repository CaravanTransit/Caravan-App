<% current_line ||= nil %>

<div class="stops-container">
  <%= link_to stop, class: 'centered row' do %>
    <%= image_tag((stop.bus? ? "bus.svg" : "train.svg"), alt: '', class: "small") %>
    <span class="stop-name"><%= stop.name %></span>
    <% if stop.train? %>
      <div class="stop-colors">
        <% stop.lines.each do |line| %>
          <div class="color-stripe" style="background-color: <%= "##{line.color}" %>"></div>
        <% end %>
      </div>
    <% end %>
  <% end %>
  <div class="centered row">
    <span><%= stop.issues.length %></span>
    <% if user_signed_in? %>
      <% if current_user.favorites.include?(stop) %>
        <%= render "favorites/favorite", stop: stop %>
      <% else %>
        <%= render "favorites/unfavorite", stop: stop %>
      <% end %>
    <% end %>
    <%= new_issue_button(stop: stop, line: current_line) %>
  </div>
</div>